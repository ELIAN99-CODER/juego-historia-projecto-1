<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Juego palabra clave SILEX</title>
<style>
  body{font-family: system-ui, -apple-system, Segoe UI, Roboto; margin:0; padding:18px; background:#f7f8fb; color:#111;}
  .wrap{max-width:900px; margin:0 auto;}
  header{display:flex;align-items:center;justify-content:space-between; gap:12px; flex-wrap:wrap;}
  h1{margin:.2rem 0;font-size:22px;}
  .wordpanel{
    font-size:32px;
    letter-spacing:12px;
    padding:10px 14px;
    background:#fff;
    border-radius:8px;
    box-shadow:0 1px 6px rgba(0,0,0,.1);
    user-select:none;
    min-width: 220px;
    text-align:center;
  }
  .menu {
    margin-top:18px;
    position: relative;
  }
  #menuBtn {
    padding: 10px 16px;
    font-size: 16px;
    background:#3b82f6;
    color:#fff;
    border:none;
    border-radius:8px;
    cursor:pointer;
    user-select:none;
  }
  #menuBtn:hover { background:#2563eb; }
  .questions-list {
    position: absolute;
    top: 44px;
    left: 0;
    background:#fff;
    border-radius:8px;
    box-shadow: 0 6px 18px rgba(0,0,0,.15);
    padding:10px;
    display:none;
    min-width: 260px;
    z-index: 10;
  }
  .questions-list button {
    display:block;
    width:100%;
    margin-bottom: 8px;
    padding:8px 10px;
    font-size:15px;
    border:1px solid #cbd5e1;
    border-radius:6px;
    background:#f8fafc;
    cursor:pointer;
    text-align:left;
  }
  .questions-list button:hover {
    background:#e0e7ff;
  }
  .modal {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,.38);
    z-index: 20;
  }
  .card {
    background:#fff;
    padding:22px 26px;
    border-radius:12px;
    max-width: 520px;
    width: 90%;
    box-shadow: 0 12px 36px rgba(0,0,0,.2);
  }
  #qtexto {
    font-weight:600;
    font-size: 18px;
    margin-bottom: 14px;
  }
  .opts {
    display:flex;
    flex-direction: column;
    gap: 10px;
  }
  .optbtn {
    padding: 12px 14px;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    background:#f8fafc;
    cursor:pointer;
    font-size: 16px;
    text-align: left;
    user-select:none;
    transition: background-color 0.15s ease;
  }
  .optbtn:hover {
    background: #dbeafe;
  }
  #closeModal {
    margin-top: 16px;
    background:#ef4444;
    color:#fff;
    border:none;
    padding: 8px 14px;
    border-radius: 8px;
    cursor:pointer;
    user-select:none;
  }
  #closeModal:hover {
    background:#dc2626;
  }
  .finalbox {
    margin-top: 26px;
    background:#fff;
    padding:16px 20px;
    border-radius:12px;
    box-shadow: 0 3px 14px rgba(0,0,0,.1);
  }
  input[type="text"] {
    padding: 12px 14px;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    width: 70%;
    font-size: 16px;
    outline-offset: 2px;
  }
  button.primary {
    padding: 12px 18px;
    border-radius: 8px;
    background:#3b82f6;
    color:#fff;
    border:none;
    cursor:pointer;
    margin-left: 10px;
    font-size: 16px;
    user-select:none;
    transition: background-color 0.2s ease;
  }
  button.primary:hover {
    background:#2563eb;
  }
  .next-btn {
    display: none;
  }
  .status {
    margin-top: 14px;
    min-height: 28px;
    font-weight: 600;
    font-size: 17px;
  }
  .correct {
    color: #059669;
  }
  .incorrect {
    color: #dc2626;
  }
  @media(max-width:600px){
    .wordpanel{font-size:26px; letter-spacing:8px;}
    input[type="text"]{width: 100%;}
    button.primary {width: 100%; margin-left:0; margin-top:8px;}
    .finalbox {padding: 14px;}
  }
</style>
</head>
<body>
<div class="wrap" role="main" aria-label="Juego palabra clave SILEX">
  <header>
    <h1>Descubre la palabra clave</h1>
    <div class="wordpanel" id="wordpanel" aria-live="polite" aria-label="Palabra clave con letras reveladas">
      <!-- Letras ocultas/reveladas aquí -->
    </div>
  </header>

  <nav class="menu" aria-label="Menú de preguntas">
    <button id="menuBtn" aria-haspopup="true" aria-expanded="false" aria-controls="questionsList">Menú de preguntas ▼</button>
    <div class="questions-list" id="questionsList" role="menu" aria-hidden="true">
      <!-- Botones preguntas se generan aquí -->
    </div>
  </nav>

  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="qtexto" aria-describedby="opts">
    <div class="card">
      <div id="qtexto"></div>
      <div class="opts" id="opts"></div>
      <button id="closeModal" aria-label="Cerrar ventana de pregunta">Cerrar</button>
    </div>
  </div>

  <section class="finalbox" aria-label="Intento final para ingresar la palabra clave">
    <label for="guessInput">Escribe la palabra clave:</label><br />
    <input type="text" id="guessInput" aria-describedby="statusLine" autocomplete="off" autocorrect="off" autocapitalize="characters" spellcheck="false" />
    <button class="primary" id="submitGuess">Validar</button>
    <button class="primary next-btn" id="nextPageBtn" aria-hidden="true">Siguiente</button>
    <div class="status" id="statusLine" aria-live="polite" role="alert"></div>
  </section>
</div>

<script>
const KEYWORD = "SILEX";
const KEYWORD_ARR = KEYWORD.split("");
// Aquí indicamos qué letra se revela en cada pregunta:
// Índices de letras a revelar (0-based)
const revealMap = {
  1: 1, // pregunta 1 revela letra índice 1 ("I")
  2: 2  // pregunta 2 revela letra índice 2 ("L")
};
// Preguntas con opciones y cuál es la correcta (0-based)
const QUESTIONS = [
  {
    id: 1,
    text: "¿De qué material estaban hechas las lanzas del paleolítico?",
    options: ["Hueso", "Piedra", "Madera"],
    correct: 1 // Piedra
  },
  {
    id: 2,
    text: "¿Qué tipo de hombre no se originó en África?",
    options: ["Neanderthal", "Homo habilis", "Australopithecus", "Homo erectus"],
    correct: 0 // Neanderthal
  }
];

let revealedIndices = [];
const wordpanel = document.getElementById("wordpanel");
const questionsList = document.getElementById("questionsList");
const modal = document.getElementById("modal");
const qtexto = document.getElementById("qtexto");
const opts = document.getElementById("opts");
const closeModalBtn = document.getElementById("closeModal");
const menuBtn = document.getElementById("menuBtn");
const guessInput = document.getElementById("guessInput");
const submitGuessBtn = document.getElementById("submitGuess");
const nextPageBtn = document.getElementById("nextPageBtn");
const statusLine = document.getElementById("statusLine");

function renderWordPanel() {
  let html = "";
  for(let i=0; i < KEYWORD_ARR.length; i++) {
    html += `<span aria-label="Letra ${i+1}" role="text" style="user-select:none; font-weight:700;">${revealedIndices.includes(i) ? KEYWORD_ARR[i] : "_"}</span>`;
  }
  wordpanel.innerHTML = html;
}

function buildMenu() {
  questionsList.innerHTML = "";
  QUESTIONS.forEach(q => {
    const btn = document.createElement("button");
    btn.textContent = `Pregunta ${q.id}`;
    btn.setAttribute("role","menuitem");
    btn.onclick = () => openQuestion(q.id);
    questionsList.appendChild(btn);
  });
}

function openQuestion(id) {
  const q = QUESTIONS.find(x=>x.id===id);
  if(!q) return;
  qtexto.textContent = `Pregunta ${q.id}: ${q.text}`;
  opts.innerHTML = "";
  q.options.forEach((opt, idx) => {
    const btn = document.createElement("button");
    btn.className = "optbtn";
    btn.textContent = opt;
    btn.onclick = () => chooseOption(q.id, idx);
    opts.appendChild(btn);
  });
  modal.style.display = "flex";
  modal.setAttribute("aria-hidden", "false");
  menuBtn.setAttribute("aria-expanded", "false");
  questionsList.style.display = "none";
}

function closeModal() {
  modal.style.display = "none";
  modal.setAttribute("aria-hidden", "true");
}

function chooseOption(qid, idx) {
  const q = QUESTIONS.find(x=>x.id===qid);
  if(idx === q.correct) {
    // Correcto
    revealLetterForQuestion(qid);
    markStatus("Correcto ✅", true);
    closeModal();
  } else {
    markStatus("Incorrecto ❌", false);
  }
}

function revealLetterForQuestion(qid) {
  const letterIndex = revealMap[qid];
  if(letterIndex === undefined) return;
  if(!revealedIndices.includes(letterIndex)) {
    revealedIndices.push(letterIndex);
  }
  renderWordPanel();
}

function markStatus(text, ok) {
  statusLine.textContent = text;
  statusLine.className = ok ? "status correct" : "status incorrect";
  setTimeout(() => {
    statusLine.textContent = "";
  }, 2500);
}

function submitGuess() {
  const val = guessInput.value.trim();
  if(!val) {
    markStatus("Escribe algo primero.", false);
    return;
  }
  if(val.toUpperCase() === KEYWORD) {
    statusLine.textContent = "CORRECTO ✅";
    statusLine.className = "status correct";
    nextPageBtn.style.display = "inline-block";
    nextPageBtn.setAttribute("aria-hidden", "false");
  } else {
    statusLine.textContent = "INCORRECTO ❌";
    statusLine.className = "status incorrect";
    nextPageBtn.style.display = "none";
    nextPageBtn.setAttribute("aria-hidden", "true");
  }
}

function toggleMenu() {
  if(questionsList.style.display === "block") {
    questionsList.style.display = "none";
    menuBtn.setAttribute("aria-expanded", "false");
  } else {
    questionsList.style.display = "block";
    menuBtn.setAttribute("aria-expanded", "true");
  }
}

function init() {
  renderWordPanel();
  buildMenu();
  closeModalBtn.onclick = closeModal;
  submitGuessBtn.onclick = submitGuess;
  menuBtn.onclick = toggleMenu;
  nextPageBtn.onclick = () => {
    alert("Aquí puedes agregar la acción para ir a la siguiente etapa o página.");
  };
  // Cerrar modal si se hace click fuera del contenido
  modal.onclick = (e) => {
    if(e.target === modal) closeModal();
  };
}

init();
</script>
</body>
</html>
